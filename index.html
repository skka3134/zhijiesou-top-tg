<!-- æ–‡ä»¶å: index.html -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç›´æ¥æœ-å¤¸å…‹ç½‘ç›˜èµ„æºæœç´¢-ç”µå½±|ç”µè§†å‰§|èµ„æ–™å…è´¹ä¸‹è½½</title>
    <meta name="description" content="ç›´æ¥æœæ˜¯ä¸€ä¸ªä¸“ä¸šçš„å¤¸å…‹ç½‘ç›˜èµ„æºæœç´¢å¼•æ“ï¼Œè‡´åŠ›äºå¸®åŠ©ç”¨æˆ·å¿«é€Ÿã€ä¾¿æ·åœ°æ‰¾åˆ°å¹¶å…è´¹ä¸‹è½½æœ€æ–°çš„ç”µå½±ã€çƒ­æ’­ç”µè§†å‰§ã€é«˜æ¸…çºªå½•ç‰‡ã€çè´µå­¦ä¹ èµ„æ–™ä»¥åŠç”µå­ä¹¦ç­‰æµ·é‡èµ„æºã€‚">
    <meta name="keywords" content="å¤¸å…‹ç½‘ç›˜,å¤¸å…‹ç½‘ç›˜æœç´¢,å¤¸å…‹èµ„æº,ç”µå½±ä¸‹è½½,ç”µè§†å‰§ä¸‹è½½,å¤¸å…‹äº‘ç›˜,èµ„æºæœç´¢,å…è´¹èµ„æº,å¤¸å…‹åˆ†äº«">
    <meta name="robots" content="index, follow">
    <!-- è¿™é‡Œéœ€è¦æ‰‹åŠ¨æ›¿æ¢ä½ çš„åŸŸåï¼Œæˆ–è€…é€šè¿‡ JS åŠ¨æ€è·å– -->
    <meta property="og:title" content="ç›´æ¥æœ - å…¨ç½‘èµ„æºä¸€é”®ç›´è¾¾">
    <meta property="og:type" content="website">
    
    <!-- æ ·å¼ä¿æŒä¸å˜ï¼Œä¸ºèŠ‚çœç¯‡å¹…çœç•¥ï¼Œè¯·æŠŠåŸä»£ç ä¸­çš„ <style>...</style> å®Œæ•´å¤åˆ¶è¿‡æ¥ -->
    <style>
        :root { --primary: #4e6ef2; --primary-hover: #4662d9; --bg-color: #f8f9fa; --card-bg: #ffffff; --text-main: #202124; --text-sub: #5f6368; --border-color: #dadce0; --shadow-sm: 0 1px 2px 0 rgba(60,64,67,0.3), 0 1px 3px 1px rgba(60,64,67,0.15); --shadow-hover: 0 4px 8px 3px rgba(60,64,67,0.15); }
        * { box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; background-color: var(--bg-color); color: var(--text-main); margin: 0; padding: 0; display: flex; flex-direction: column; min-height: 100vh; }
        .header { background: var(--card-bg); border-bottom: 1px solid var(--border-color); padding: 20px 0; text-align: center; box-shadow: 0 1px 6px rgba(32,33,36,0.1); }
        .logo { font-size: 28px; font-weight: 800; color: var(--primary); margin-bottom: 15px; display: inline-block; letter-spacing: -0.5px; }
        .container { width: 100%; max-width: 800px; margin: 0 auto; padding: 20px; flex: 1; }
        .search-wrapper { position: relative; margin: 0 auto 30px auto; max-width: 600px; }
        .search-box { display: flex; align-items: center; background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 24px; padding: 5px 5px 5px 20px; transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); box-shadow: 0 1px 6px rgba(32,33,36,0.1); }
        .search-box:hover, .search-box:focus-within { box-shadow: 0 2px 12px rgba(32,33,36,0.2); border-color: transparent; }
        input { flex: 1; border: none; font-size: 16px; outline: none; color: var(--text-main); padding: 10px 0; background: transparent; }
        button.search-btn { background: var(--primary); color: white; border: none; border-radius: 20px; padding: 10px 24px; font-weight: 600; cursor: pointer; transition: background 0.2s; margin-left: 10px; }
        button.search-btn:hover { background: var(--primary-hover); }
        .tags-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 20px; font-size: 13px; }
        .tag-ad { background-color: #fff0e0; color: #d97706; padding: 6px 12px; border-radius: 16px; text-decoration: none; transition: opacity 0.2s; border: 1px solid #ffedd5; }
        .tag-ad:hover { opacity: 0.8; }
        .result-list { display: flex; flex-direction: column; gap: 15px; }
        .card { background: var(--card-bg); padding: 18px; border-radius: 12px; border: 1px solid var(--border-color); text-decoration: none; color: inherit; display: flex; align-items: start; transition: transform 0.2s, box-shadow 0.2s; }
        .card:hover { transform: translateY(-2px); box-shadow: var(--shadow-hover); border-color: transparent; }
        .card-icon { font-size: 24px; margin-right: 15px; flex-shrink: 0; background: #f1f3f4; width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; border-radius: 8px; }
        .card-content { flex: 1; min-width: 0; }
        .card-title { font-size: 16px; font-weight: 600; color: #1a0dab; margin-bottom: 6px; line-height: 1.4; word-wrap: break-word; }
        .card-meta { display: flex; align-items: center; gap: 10px; font-size: 12px; color: var(--text-sub); }
        .drive-badge { padding: 2px 6px; border-radius: 4px; font-weight: 500; background: #e8f0fe; color: #1967d2; }
        .drive-badge.quark { background: #e6f4ea; color: #137333; }
        .pagination { display: flex; justify-content: center; align-items: center; gap: 15px; margin-top: 40px; margin-bottom: 20px; }
        .page-btn { background: white; border: 1px solid var(--border-color); color: var(--text-main); padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 14px; }
        .page-btn:hover:not(:disabled) { background: #f1f3f4; color: var(--primary); }
        .page-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        #loading { text-align: center; margin: 40px 0; color: var(--text-sub); display: none; }
        .spinner { display: inline-block; width: 30px; height: 30px; border: 3px solid rgba(78,110,242,0.3); border-radius: 50%; border-top-color: var(--primary); animation: spin 1s ease-in-out infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .error { background: #fce8e6; color: #c5221f; padding: 12px; border-radius: 8px; text-align: center; margin: 10px 0; font-size: 14px; }
        .empty-state { text-align: center; color: var(--text-sub); padding: 40px 0; }
        footer { background: var(--card-bg); border-top: 1px solid var(--border-color); padding: 20px; text-align: center; font-size: 12px; color: #999; margin-top: auto; }
        @media (max-width: 600px) { .container { padding: 15px; } .card { padding: 15px; } .logo { font-size: 24px; } }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">ğŸ” ç›´æ¥æœ</div>
        <div style="font-size: 14px; color: var(--text-sub);">å¤¸å…‹ç½‘ç›˜èµ„æº ç”µå½±|ç”µè§†å‰§|èµ„æ–™ å…è´¹ä¸‹è½½</div>
    </div>
    <div class="container">
        <!-- æœç´¢æ ç­‰ HTML ç»“æ„ä¿æŒä¸å˜ï¼Œç›´æ¥å¤åˆ¶ -->
        <div class="search-wrapper">
            <div class="search-box">
                <span style="font-size: 18px; color: #9aa0a6;">ğŸ”</span>
                <input type="text" id="kw" placeholder="è¾“å…¥å…³é”®è¯ (å¦‚: åº†ä½™å¹´, è€ƒç ”èµ„æ–™)..." onkeydown="if(event.keyCode==13) doSearch(1)">
                <button class="search-btn" onclick="doSearch(1)">æœç´¢</button>
            </div>
        </div>
        <div class="tags-container" id="adsContainer"></div>
        <div id="loading"><div class="spinner"></div><p>æ­£åœ¨å…¨ç½‘æœç´¢ä¸­...</p></div>
        <div id="error" class="error" style="display:none;"></div>
        <div id="results" class="result-list"></div>
        <div id="pagination" class="pagination" style="display: none;">
            <button class="page-btn" id="prevBtn" onclick="changePage(-1)">ä¸Šä¸€é¡µ</button>
            <span id="pageInfo" style="color: var(--text-sub); font-size: 14px;">1 / 1</span>
            <button class="page-btn" id="nextBtn" onclick="changePage(1)">ä¸‹ä¸€é¡µ</button>
        </div>
    </div>
    <footer>
        <p>å…è´£å£°æ˜ï¼šæœ¬ç«™èµ„æºå‡æ¥æºäºç½‘ç»œï¼Œä»…ä¾›å­¦ä¹ äº¤æµï¼Œè¯·äºä¸‹è½½å24å°æ—¶å†…åˆ é™¤ã€‚</p>
        <p>Powered by Cloudflare Workers & D1 | 2024 Â© ç›´æ¥æœ</p>
    </footer>
    <script>
        // ğŸ”´ é‡ç‚¹ï¼šåœ¨è¿™é‡Œé…ç½®å‰ç«¯å¹¿å‘Šï¼Œä¸éœ€è¦é€šè¿‡åç«¯æ³¨å…¥äº†
        const ADS = [
          {
            'text': "ğŸ“± æµé‡å¡åŠç†",
            'url': "https://h5.lot-ml.com/ProductEn/Index/70fedaf6239f2173"
          },
          {
            'text': "âœˆï¸ æœºåœºæ¨è",
            'url': "https://naiixi.com/signupbyemail.aspx?MemberCode=b2f3ab200e774fd5b921e274669c900420251030144409"
          }
        ];
        
        // å‰©ä½™çš„ JS é€»è¾‘ä¿æŒä¸å˜ï¼Œç›´æ¥å¤åˆ¶
        const adsContainer = document.getElementById('adsContainer');
        if(ADS && ADS.length > 0) {
            ADS.forEach(ad => {
                const a = document.createElement('a');
                a.href = ad.url;
                a.className = 'tag-ad';
                a.target = '_blank';
                a.innerHTML = ad.text;
                adsContainer.appendChild(a);
            });
        }
        let currentPage = 1;
        let currentQuery = '';
        let totalPages = 1;
        async function doSearch(page) {
            const kw = document.getElementById('kw').value.trim();
            if (!kw) return;
            currentQuery = kw;
            currentPage = page;
            document.getElementById('loading').style.display = 'block';
            document.getElementById('results').innerHTML = '';
            document.getElementById('error').style.display = 'none';
            document.getElementById('pagination').style.display = 'none';
            const newUrl = new URL(window.location);
            newUrl.searchParams.set('q', kw);
            newUrl.searchParams.set('page', page);
            window.history.pushState({}, '', newUrl);
            try {
                const res = await fetch(`/api/search?q=${encodeURIComponent(kw)}&page=${page}`);
                const json = await res.json();
                document.getElementById('loading').style.display = 'none';
                if (!json.success) {
                    const errDiv = document.getElementById('error');
                    errDiv.innerText = json.error || 'æœç´¢å¤±è´¥';
                    errDiv.style.display = 'block';
                    return;
                }
                if (json.data.length === 0) {
                    document.getElementById('results').innerHTML = '<div class="empty-state">â˜ï¸ æš‚æ—¶æ²¡æœ‰æ‰¾åˆ°ç›¸å…³èµ„æº<br>è¯·å°è¯•æ›´æ¢æ›´çŸ­çš„å…³é”®è¯</div>';
                    return;
                }
                renderResults(json.data);
                updatePagination(json.pagination);
                window.scrollTo({ top: 0, behavior: 'smooth' });
            } catch (e) {
                document.getElementById('loading').style.display = 'none';
                const errDiv = document.getElementById('error');
                errDiv.innerText = 'ç½‘ç»œè¯·æ±‚å‡ºé”™ï¼Œè¯·ç¨åé‡è¯•';
                errDiv.style.display = 'block';
            }
        }
        // ... (å‰©ä¸‹çš„ renderResults, updatePagination ç­‰å‡½æ•°ä»£ç å®Œå…¨ä¸€æ ·ï¼Œå¤åˆ¶å³å¯) ...
        function renderResults(data) {
            const container = document.getElementById('results');
            data.forEach(item => {
                const isAli = item.drive_type === 1;
                const driveName = isAli ? 'é˜¿é‡Œäº‘ç›˜' : 'å¤¸å…‹ç½‘ç›˜';
                const badgeClass = isAli ? 'drive-badge' : 'drive-badge quark';
                const iconChar = isAli ? 'âš¡' : 'â˜ï¸';
                const html = `
                    <a href="${item.short_url}" target="_blank" class="card">
                        <div class="card-icon">${iconChar}</div>
                        <div class="card-content">
                            <div class="card-title">${escapeHtml(item.title)}</div>
                            <div class="card-meta">
                                <span class="${badgeClass}">${driveName}</span>
                                <span>ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…</span>
                            </div>
                        </div>
                    </a>
                `;
                container.innerHTML += html;
            });
        }
        function updatePagination(pagination) {
            totalPages = pagination.totalPages;
            document.getElementById('pageInfo').innerText = `${pagination.page} / ${pagination.totalPages}`;
            document.getElementById('prevBtn').disabled = !pagination.hasPrev;
            document.getElementById('nextBtn').disabled = !pagination.hasNext;
            if (pagination.totalPages > 1) {
                document.getElementById('pagination').style.display = 'flex';
            }
        }
        function changePage(delta) {
            const newPage = currentPage + delta;
            if (newPage >= 1 && newPage <= totalPages) {
                doSearch(newPage);
            }
        }
        function escapeHtml(text) {
            if (!text) return '';
            return text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;");
        }
        window.onload = function() {
            const params = new URLSearchParams(window.location.search);
            const q = params.get('q');
            if(q) {
                document.getElementById('kw').value = q;
                const p = parseInt(params.get('page')) || 1;
                doSearch(p);
            }
        }
    </script>
</body>
</html>
